<div class="page-header">
Â  <h2>AssetFlow - GestiÃ³n de CategorÃ­as</h2>

Â  <button 
Â  Â  class="btn btn-primary"
Â  Â  (click)="abrirFormularioCreacion()"
Â  Â  [disabled]="cargando">
Â  Â  â• Nueva CategorÃ­a
Â  </button>
</div>

<div *ngIf="cargando" class="loading-overlay">
Â  <div class="spinner"></div>
Â  <p>Cargando categorÃ­as...</p>
</div>

<div *ngIf="errorCarga" class="alert alert-danger">
Â  <strong>âš ï¸ Error de ConexiÃ³n</strong>
Â  <p>No se pudo conectar con la API de CategorÃ­as. {{ errorCarga.message }}</p>
Â  
Â  <button class="btn btn-sm btn-outline-danger" (click)="recargarCategorias()">
Â  Â  ğŸ”„ Reintentar
Â  </button>
</div>

<div 
Â  *ngIf="mensajeUsuario"
Â  class="alert"
Â  [ngClass]="{
Â  Â  'alert-success': tipoMensaje === 'success',
Â  Â  'alert-danger': tipoMensaje === 'error',
Â  Â  'alert-info': tipoMensaje === 'info'
Â  }"
Â  role="alert">

Â  <span class="close-btn" (click)="cerrarMensaje()" title="Cerrar">âœ•</span>

Â  <div style="white-space: pre-line;">
Â  Â  {{ mensajeUsuario }}
Â  </div>
</div>

<div *ngIf="categorias$ | async as categorias; else cargandoTemplate">

Â  <div *ngIf="categorias.length === 0 && !cargando" class="empty-state">
Â  Â  <div class="empty-icon">ğŸ“‚</div>
Â  Â  <h3>No hay categorÃ­as registradas</h3>
Â  Â  <p>Comience agregando su primera categorÃ­a.</p>

Â  Â  <button class="btn btn-primary" (click)="abrirFormularioCreacion()">
Â  Â  Â  â• Crear Primera CategorÃ­a
Â  Â  </button>
Â  </div>

Â  <div *ngIf="categorias.length > 0" class="categorias-container">

Â  Â  <app-lista-tabla
Â  Â  Â  [datos]="categorias"
Â  Â  Â  (itemEliminado)="manejarEliminacion($event)"
Â  Â  Â  (itemEditado)="manejarEdicion($any($event))"
      (itemVisualizado)="manejarVisualizacion($any($event))"> Â  Â  </app-lista-tabla>

Â  </div>
</div>

<ng-template #cargandoTemplate>
Â  <div class="loading-placeholder">
Â  Â  <div class="skeleton-row" *ngFor="let item of [1,2,3,4,5]"></div>
Â  </div>
</ng-template>

<div 
Â  *ngIf="mostrarFormulario"
Â  class="modal-overlay"
Â  (click)="cerrarFormulario()">

Â  <div class="modal-content" (click)="$event.stopPropagation()">
Â  Â  
Â  Â  <div class="modal-header">
Â  Â  Â  <h3>
Â  Â  Â  Â  {{ modoEdicion ? 'Editar CategorÃ­a: ' + categoriaAEditar?.nombre : 'Nueva CategorÃ­a' }}
Â  Â  Â  </h3>

Â  Â  Â  <button class="close-btn" (click)="cerrarFormulario()">âœ•</button>
Â  Â  </div>

Â  Â  <div class="modal-body">
Â  Â  Â  <app-categoria-form
Â  Â  Â  Â  [categoriaInicial]="categoriaAEditar"
Â  Â  Â  Â  (categoriaGuardada)="manejarGuardado($event)"
Â  Â  Â  Â  (cancelar)="cerrarFormulario()">
Â  Â  Â  </app-categoria-form>
Â  Â  </div>

Â  </div>
</div>

<div *ngIf="mostrarDetalles" class="modal-overlay" (click)="cerrarDetalles()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    
    <div class="modal-header">
      <h3>Detalles de la CategorÃ­a: {{ categoriaAVisualizar?.nombre }}</h3>
      <button class="close-btn" (click)="cerrarDetalles()">âœ•</button>
    </div>

    <div class="modal-body" *ngIf="categoriaAVisualizar as categoria">
      <div class="details-grid">
        <p><strong>ID:</strong> {{ categoria.id }}</p>
        <p><strong>CÃ³digo:</strong> {{ categoria.codigo }}</p>
        <p><strong>Activa:</strong> 
          <span class="badge" [ngClass]="categoria.activa ? 'badge-success' : 'badge-secondary'">
            {{ categoria.activa ? 'SÃ­' : 'No' }}
          </span>
        </p>
        <p><strong>Total Activos:</strong> {{ categoria.total_activos || 0 }}</p>
        <p><strong>Valor Total:</strong> {{ (categoria.valor_total || 0) | currency:'USD':'symbol':'1.2-2' }}</p>
        <p><strong>Creado en:</strong> {{ categoria.creado_en | date:'short' }}</p>
        <p><strong>Actualizado en:</strong> {{ categoria.actualizado_en | date:'short' }}</p>
        <p class="full-row"><strong>DescripciÃ³n:</strong> {{ categoria.descripcion || 'Sin descripciÃ³n' }}</p>
      </div>
    </div>
    
    <div class="modal-footer">
      <button class="btn btn-secondary" (click)="cerrarDetalles()">Cerrar</button>
    </div>

  </div>
</div>